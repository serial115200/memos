#!/bin/dash

ENV_DOCKERFILE="$(sed -e 's/#.*$//' -e '/^$/d' $1)"

pkg2dockerfile()
{
cat > Dockerfile <<-EOF
FROM ubuntu:20.04

ENV DEBIAN_FRONTEND=noninteractive

RUN     apt-get update \\
    &&  apt-get install --no-install-recommends -y \\
EOF

for pkg in "$@"; do
    printf "            %-38s %s\n" "${pkg}" "\\">> Dockerfile
done

cat >> Dockerfile <<-EOF
    &&  apt-get autoremove \\
    &&  apt-get clean \\
    &&  rm -rf /var/lib/apt/lists/*

RUN ln -sf /bin/bash /bin/sh

WORKDIR /build

CMD ["bash"]
EOF
}

# shellcheck disable=SC2086
pkg2dockerfile ${ENV_DOCKERFILE}
